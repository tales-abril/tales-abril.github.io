<script>
  const SHEET_JSON_URL = "https://docs.google.com/spreadsheets/d/1kTVlPxRR8XJJmfvFXuhtwLCqzvtQGBD2dyki5vZy5Gw/gviz/tq?tqx=out:json&sheet=Robots";

  fetch(SHEET_JSON_URL)
    .then(res => res.text())
    .then(txt => {
      if (txt.startsWith("<")) {
        throw new Error("La hoja no es pública o la URL está mal");
      }
      const json = JSON.parse(txt.substr(47).slice(0, -2)); // Limpia el JSON raro de Google
      const rows = json.table.rows;

      const container = document.getElementById("robots");
      rows.forEach(r => {
        const nombre = r.c[1]?.v || "";
        const categoria = r.c[2]?.v || "";
        const imagen = r.c[3]?.v || "";

        const div = document.createElement("div");
        div.className = "robot";
        div.innerHTML = `<h3>${nombre}</h3><p>${categoria}</p><img src="${imagen}" alt="${nombre}">`;
        container.appendChild(div);
      });
    })
    .catch(err => {
      document.getElementById("robots").innerText = "❌ Error: " + err.message;
    });
</script>
