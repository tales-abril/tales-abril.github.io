<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Liga Nacional de Robótica</title>
<link rel="icon" href="data:,">
<style>
body {
    margin:0; font-family: Arial,sans-serif;
    background: linear-gradient(135deg,#0a0a2a,#1a1a3d);
    color:#fff;
    display:flex; justify-content:center; padding:20px;
}
#login,#app {
    background: rgba(26,26,61,0.9);
    padding: 20px;
    border-radius: 15px;
    width: 100%; max-width: 900px;
    box-shadow: 0 0 20px #4b2b82;
    transition: all 0.5s ease;
}
input, select, button {
    width:100%; padding:10px; margin:6px 0; border-radius:5px; border:none; font-size:1em; transition:all 0.3s ease;
}
button { background:#4b2b82; color:#fff; cursor:pointer; font-weight:bold;}
button:hover { background:#6a0dad; transform:scale(1.05);}
h2,h3 { text-align:center; color:#9b30ff; margin:10px 0; opacity:0; animation:fadeIn 1s ease forwards;}
@keyframes fadeIn { to{opacity:1;} }
table { width:100%; border-collapse:collapse; margin-top:10px; transition:all 0.5s ease;}
th,td { padding:6px; border:1px solid #444; text-align:center; font-size:0.9em;}
img { border-radius:10px; max-width:50px; }
.section { display:none; margin-top:10px; opacity:0; transition:opacity 0.5s ease;}
.section.show { display:block; opacity:1; }
.nav-buttons button { width:auto; margin-right:5px; display:inline-block;}
select.robotSelect { width:auto; display:inline-block; margin-right:5px; }
</style>
</head>
<body>

<div id="login">
<h2>Login Admin</h2>
<input type="password" id="password" placeholder="Contraseña">
<button onclick="login()">Entrar</button>
</div>

<div id="app">
<h2>Liga Nacional de Robótica</h2>
<div class="nav-buttons">
<button onclick="showSection('inicial')">Escuela Inicial</button>
<button onclick="showSection('general')">Categorías Generales</button>
<button onclick="showSection('robots')">Robots</button>
<button onclick="showSection('ganadores')">Ganadores</button>
</div>

<!-- SECCIONES -->
<div id="inicial" class="section">
<h3>Escuela Inicial (Batallas y Dibujos)</h3>
<div id="battleInicial">
<select id="robot1Inicial" class="robotSelect"></select>
<select id="robot2Inicial" class="robotSelect"></select>
<button onclick="registrarGanador('inicial')">Registrar Ganador</button>
</div>
</div>

<div id="general" class="section">
<h3>Categorías Generales</h3>
<div id="battleGeneral">
<select id="robot1General" class="robotSelect"></select>
<select id="robot2General" class="robotSelect"></select>
<button onclick="registrarGanador('general')">Registrar Ganador</button>
</div>
</div>

<div id="robots" class="section">
<h3>Robots Generales</h3>
<table id="robotsTableGeneral">
<thead><tr><th>Nombre</th><th>Foto</th><th>Puntos</th></tr></thead>
<tbody></tbody>
</table>
</div>

<div id="ganadores" class="section">
<h3>Ganadores</h3>
<div id="ganadoresList"></div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function(){
const ADMIN_PASSWORD="1234";

// Array de robots desde localStorage
let robots = JSON.parse(localStorage.getItem('robots')) || [];

// LOGIN
window.login = function(){
    const pass=document.getElementById('password').value;
    if(pass===ADMIN_PASSWORD){
        document.getElementById('login').style.display='none';
        document.getElementById('app').style.display='block';
        cargarRobots();
        actualizarSelects();
        cargarGanadores();
    }else alert("Contraseña incorrecta");
}

// SECCIONES
window.showSection = function(sec){
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('show'));
    const section = document.getElementById(sec);
    if(section) section.classList.add('show');
}

// CARGAR ROBOTS EN LA TABLA
function cargarRobots(){
    const tableBody = document.querySelector('#robotsTableGeneral tbody');
    tableBody.innerHTML='';
    robots.forEach(robot=>{
        const row = document.createElement('tr');
        row.innerHTML=`<td>${robot.name}</td>
        <td>${robot.photo ? '<img src="'+robot.photo+'">' : ''}</td>
        <td>${robot.points || 0}</td>`;
        tableBody.appendChild(row);
    });
}

// ACTUALIZAR SELECTS PARA BATALLAS
function actualizarSelects(){
    ['robot1Inicial','robot2Inicial','robot1General','robot2General'].forEach(id=>{
        const sel = document.getElementById(id);
        sel.innerHTML='';
        robots.forEach((r,index)=>{
            const opt = document.createElement('option');
            opt.value=index; opt.text=r.name;
            sel.appendChild(opt);
        });
    });
}

// REGISTRAR GANADOR
window.registrarGanador = function(tipo){
    let sel1, sel2;
    if(tipo==='inicial'){ sel1='robot1Inicial'; sel2='robot2Inicial'; }
    else{ sel1='robot1General'; sel2='robot2General'; }

    const r1index = parseInt(document.getElementById(sel1).value);
    const r2index = parseInt(document.getElementById(sel2).value);

    if(r1index===r2index) return alert("Selecciona robots diferentes");

    let ganadorNombre = prompt("Ingresa el nombre del ganador:");
    if(!ganadorNombre) return alert("Debes indicar ganador");

    robots.forEach((r,i)=>{
        if(r.name === ganadorNombre){
            r.points = (r.points || 0) + 1;
        } else if(i===r1index || i===r2index){
            r.points = (r.points || 0) + 0.5;
        }
    });

    localStorage.setItem('robots', JSON.stringify(robots));
    cargarRobots();
    cargarGanadores();
}

// CARGAR GANADORES
function cargarGanadores(){
    const list = document.getElementById('ganadoresList');
    list.innerHTML='';
    robots.forEach(robot=>{
        if(robot.points && robot.points>0){
            const div = document.createElement('div');
            div.textContent=`${robot.name}: ${robot.points} puntos`;
            list.appendChild(div);
        }
    });
}
});
</script>

</body>
</html>
